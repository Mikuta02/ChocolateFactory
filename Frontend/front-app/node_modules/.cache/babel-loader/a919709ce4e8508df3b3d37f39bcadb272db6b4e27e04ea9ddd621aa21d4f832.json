{"ast":null,"code":"import { createElementVNode as _createElementVNode, vModelText as _vModelText, withDirectives as _withDirectives, toDisplayString as _toDisplayString, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, withModifiers as _withModifiers, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nconst _withScopeId = n => (_pushScopeId(\"data-v-ef68022e\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"h2\", null, \"Please enter your credentials to log in\", -1 /* HOISTED */));\nconst _hoisted_2 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"label\", null, \"Username:\", -1 /* HOISTED */));\nconst _hoisted_3 = {\n  key: 0,\n  class: \"error\"\n};\nconst _hoisted_4 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"label\", null, \"Password:\", -1 /* HOISTED */));\nconst _hoisted_5 = {\n  key: 0,\n  class: \"error\"\n};\nconst _hoisted_6 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"button\", {\n  type: \"submit\"\n}, \"Log in\", -1 /* HOISTED */));\nconst _hoisted_7 = {\n  key: 0,\n  class: \"error\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"form\", {\n    onSubmit: _withModifiers($setup.login, [\"prevent\"]),\n    class: \"login-form\"\n  }, [_hoisted_1, _createElementVNode(\"div\", null, [_hoisted_2, _withDirectives(_createElementVNode(\"input\", {\n    type: \"text\",\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $setup.username = $event),\n    placeholder: \"Username\",\n    onBlur: $setup.validateUsername\n  }, null, 544 /* NEED_HYDRATION, NEED_PATCH */), [[_vModelText, $setup.username]]), $setup.errors.username ? (_openBlock(), _createElementBlock(\"span\", _hoisted_3, _toDisplayString($setup.errors.username), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true)]), _createElementVNode(\"div\", null, [_hoisted_4, _withDirectives(_createElementVNode(\"input\", {\n    type: \"password\",\n    \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => $setup.password = $event),\n    onBlur: $setup.validatePassword\n  }, null, 544 /* NEED_HYDRATION, NEED_PATCH */), [[_vModelText, $setup.password]]), $setup.errors.password ? (_openBlock(), _createElementBlock(\"span\", _hoisted_5, _toDisplayString($setup.errors.password), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true)]), _hoisted_6, $setup.errors.general ? (_openBlock(), _createElementBlock(\"span\", _hoisted_7, _toDisplayString($setup.errors.general), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true)], 32 /* NEED_HYDRATION */);\n}","map":{"version":3,"names":["_createElementVNode","key","class","type","_createElementBlock","onSubmit","_withModifiers","$setup","login","_hoisted_1","_hoisted_2","_cache","$event","username","placeholder","onBlur","validateUsername","errors","_hoisted_3","_toDisplayString","_createCommentVNode","_hoisted_4","password","validatePassword","_hoisted_5","_hoisted_6","general","_hoisted_7"],"sources":["C:\\FTN\\treca\\drugi_sem\\veb\\chocolate-factoryapp\\Frontend\\front-app\\src\\components\\Login.vue"],"sourcesContent":["<template>\r\n    <form @submit.prevent=\"login\" class=\"login-form\">\r\n      <h2>Please enter your credentials to log in</h2>\r\n      <div>\r\n        <label>Username:</label>\r\n        <input type=\"text\" v-model=\"username\" placeholder=\"Username\" @blur=\"validateUsername\"/>\r\n        <span v-if=\"errors.username\" class=\"error\">{{ errors.username }}</span>\r\n      </div>\r\n      <div>\r\n        <label>Password:</label>\r\n        <input type=\"password\" v-model=\"password\" @blur=\"validatePassword\"/>\r\n        <span v-if=\"errors.password\" class=\"error\">{{ errors.password }}</span>\r\n      </div>\r\n      <button type=\"submit\">Log in</button>\r\n      <span v-if=\"errors.general\" class=\"error\">{{ errors.general }}</span>\r\n    </form>\r\n  </template>\r\n  \r\n  <script setup>\r\n  import { ref } from 'vue';\r\n  import axios from 'axios';\r\n  import { useStore } from 'vuex';\r\n  import { useRouter } from 'vue-router';\r\n  \r\n  const router = useRouter();\r\n  const username = ref('');\r\n  const password = ref('');\r\n  const errors = ref({});\r\n  const store = useStore();\r\n  \r\n  function validateUsername() {\r\n    if (!username.value) {\r\n      errors.value.username = 'Username is required';\r\n    } else {\r\n      errors.value.username = '';\r\n    }\r\n  }\r\n  \r\n  function validatePassword() {\r\n    if (!password.value) {\r\n      errors.value.password = 'Password is required';\r\n    } else {\r\n      errors.value.password = '';\r\n    }\r\n  }\r\n  \r\n  function login() {\r\n    validateUsername();\r\n    validatePassword();\r\n  \r\n    if (errors.value.username || errors.value.password) {\r\n      return;\r\n    }\r\n  \r\n    const userToLogin = {\r\n      username: username.value,\r\n      password: password.value\r\n    };\r\n  \r\n    axios.post('http://localhost:3001/api/login', userToLogin, { withCredentials: true })\r\n      .then(response => {\r\n        store.commit('setToken', response.data.token);\r\n        router.push('/factories');\r\n      })\r\n      .catch(error => {\r\n        if (error.response) {\r\n          if (error.response.status === 404) {\r\n            errors.value.general = 'Username doesn\\'t exist';\r\n          } else if (error.response.status === 401) {\r\n            errors.value.general = 'Incorrect password';\r\n          } else if (error.response.status === 403) {\r\n            errors.value.general = 'User is banned';\r\n          } else {\r\n            errors.value.general = 'There was an error logging in!';\r\n          }\r\n        } else {\r\n          console.error('There was an error logging in!', error);\r\n        }\r\n      });\r\n  }\r\n  </script>\r\n  \r\n  <style scoped>\r\n  .login-form {\r\n    max-width: 600px;\r\n    margin: 0 auto;\r\n    padding: 20px;\r\n    background-color: #f5f5f5;\r\n    border-radius: 10px;\r\n    box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);\r\n  }\r\n  \r\n  .login-form h2 {\r\n    text-align: center;\r\n    color: #4b3832;\r\n    font-family: 'Arial', sans-serif;\r\n    font-size: 2em;\r\n    font-weight: bold;\r\n    margin-bottom: 20px;\r\n    text-transform: uppercase;\r\n    font-style: italic;\r\n  }\r\n  \r\n  .login-form div {\r\n    margin-bottom: 15px;\r\n  }\r\n  \r\n  .login-form label {\r\n    display: block;\r\n    margin-bottom: 5px;\r\n    font-weight: bold;\r\n  }\r\n  \r\n  .login-form input {\r\n    width: 100%;\r\n    padding: 8px;\r\n    box-sizing: border-box;\r\n    border: 1px solid #ccc;\r\n    border-radius: 5px;\r\n  }\r\n  \r\n  .login-form button {\r\n    display: block;\r\n    width: 100%;\r\n    padding: 10px;\r\n    background-color: #42b983;\r\n    color: white;\r\n    border: none;\r\n    border-radius: 5px;\r\n    cursor: pointer;\r\n    font-size: 1em;\r\n  }\r\n  \r\n  .login-form button:hover {\r\n    background-color: #3a9d70;\r\n  }\r\n  \r\n  .error {\r\n    color: red;\r\n    font-size: 0.8em;\r\n  }\r\n  </style>\r\n  "],"mappings":";;gEAEMA,mBAAA,CAAgD,YAA5C,yCAAuC;gEAEzCA,mBAAA,CAAwB,eAAjB,WAAS;;EAJxBC,GAAA;EAMqCC,KAAK,EAAC;;gEAGnCF,mBAAA,CAAwB,eAAjB,WAAS;;EATxBC,GAAA;EAWqCC,KAAK,EAAC;;gEAErCF,mBAAA,CAAqC;EAA7BG,IAAI,EAAC;AAAQ,GAAC,QAAM;;EAblCF,GAAA;EAckCC,KAAK,EAAC;;;uBAbpCE,mBAAA,CAcO;IAdAC,QAAM,EADjBC,cAAA,CAC2BC,MAAA,CAAAC,KAAK;IAAEN,KAAK,EAAC;MAClCO,UAAgD,EAChDT,mBAAA,CAIM,cAHJU,UAAwB,E,gBACxBV,mBAAA,CAAuF;IAAhFG,IAAI,EAAC,MAAM;IAL1B,uBAAAQ,MAAA,QAAAA,MAAA,MAAAC,MAAA,IAKoCL,MAAA,CAAAM,QAAQ,GAAAD,MAAA;IAAEE,WAAW,EAAC,UAAU;IAAEC,MAAI,EAAER,MAAA,CAAAS;iEAAxCT,MAAA,CAAAM,QAAQ,E,GACxBN,MAAA,CAAAU,MAAM,CAACJ,QAAQ,I,cAA3BT,mBAAA,CAAuE,QAAvEc,UAAuE,EAAAC,gBAAA,CAAzBZ,MAAA,CAAAU,MAAM,CAACJ,QAAQ,oBANrEO,mBAAA,e,GAQMpB,mBAAA,CAIM,cAHJqB,UAAwB,E,gBACxBrB,mBAAA,CAAoE;IAA7DG,IAAI,EAAC,UAAU;IAV9B,uBAAAQ,MAAA,QAAAA,MAAA,MAAAC,MAAA,IAUwCL,MAAA,CAAAe,QAAQ,GAAAV,MAAA;IAAGG,MAAI,EAAER,MAAA,CAAAgB;iEAAjBhB,MAAA,CAAAe,QAAQ,E,GAC5Bf,MAAA,CAAAU,MAAM,CAACK,QAAQ,I,cAA3BlB,mBAAA,CAAuE,QAAvEoB,UAAuE,EAAAL,gBAAA,CAAzBZ,MAAA,CAAAU,MAAM,CAACK,QAAQ,oBAXrEF,mBAAA,e,GAaMK,UAAqC,EACzBlB,MAAA,CAAAU,MAAM,CAACS,OAAO,I,cAA1BtB,mBAAA,CAAqE,QAArEuB,UAAqE,EAAAR,gBAAA,CAAxBZ,MAAA,CAAAU,MAAM,CAACS,OAAO,oBAdjEN,mBAAA,e","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}