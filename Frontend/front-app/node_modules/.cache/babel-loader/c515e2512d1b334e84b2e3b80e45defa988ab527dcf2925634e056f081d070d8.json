{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/web.dom-exception.stack.js\";\nimport { ref, onMounted } from 'vue';\nimport axios from 'axios';\nimport { useStore } from 'vuex';\nimport { useRouter } from 'vue-router';\nexport default {\n  __name: 'RegisterWorker',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const router = useRouter();\n    const store = useStore();\n    const username = ref('');\n    const password = ref('');\n    const confirmPassword = ref('');\n    const name = ref('');\n    const lastName = ref('');\n    const gender = ref('Male');\n    const birthDate = ref('');\n    const worksAtFactoryId = ref('');\n    const errors = ref({});\n    const token = store.state.token; // Get token from the store\n\n    const payload = JSON.parse(atob(token.split('.')[1]));\n    const userId = payload.userId;\n    const userRole = payload.role;\n    onMounted(() => {\n      loadFactory();\n    });\n    function loadFactory() {\n      axios.get(`http://localhost:3001/api/factories/manager/${userId}`).then(response => {\n        worksAtFactoryId.value = response.data.id;\n      }).catch(error => {\n        console.error('There was an error fetching the factories!', error);\n      });\n    }\n    function validateUsername() {\n      if (!username.value) {\n        errors.value.username = 'Username is required';\n      } else {\n        errors.value.username = '';\n      }\n    }\n    function validatePassword() {\n      if (!password.value) {\n        errors.value.password = 'Password is required';\n      } else if (password.value !== confirmPassword.value) {\n        errors.value.confirmPassword = 'Passwords do not match';\n      } else {\n        errors.value.password = '';\n        errors.value.confirmPassword = '';\n      }\n    }\n    function validateName() {\n      if (!name.value) {\n        errors.value.name = 'Name is required';\n      } else {\n        errors.value.name = '';\n      }\n    }\n    function validateLastName() {\n      if (!lastName.value) {\n        errors.value.lastName = 'Last Name is required';\n      } else {\n        errors.value.lastName = '';\n      }\n    }\n    function validateBirthDate() {\n      if (!birthDate.value) {\n        errors.value.birthDate = 'Date of Birth is required';\n      } else {\n        errors.value.birthDate = '';\n      }\n    }\n    function register() {\n      validateUsername();\n      validatePassword();\n      validateName();\n      validateLastName();\n      validateBirthDate();\n      if (errors.value.username || errors.value.password || errors.value.confirmPassword || errors.value.name || errors.value.lastName || errors.value.birthDate) {\n        return;\n      }\n      const userToRegister = {\n        username: username.value,\n        password: password.value,\n        name: name.value,\n        lastName: lastName.value,\n        gender: gender.value,\n        birthDate: birthDate.value,\n        worksAtFactoryId: worksAtFactoryId.value\n      };\n      axios.post(`http://localhost:3001/api/signupworker`, userToRegister).then(response => {\n        router.push('/login');\n      }).catch(error => {\n        if (error.response && error.response.data.error === 'Username already exists') {\n          errors.value.username = 'Username already taken';\n        } else {\n          console.error('There was an error registering!', error);\n        }\n      });\n    }\n    const __returned__ = {\n      router,\n      store,\n      username,\n      password,\n      confirmPassword,\n      name,\n      lastName,\n      gender,\n      birthDate,\n      worksAtFactoryId,\n      errors,\n      token,\n      payload,\n      userId,\n      userRole,\n      loadFactory,\n      validateUsername,\n      validatePassword,\n      validateName,\n      validateLastName,\n      validateBirthDate,\n      register,\n      ref,\n      onMounted,\n      get axios() {\n        return axios;\n      },\n      get useStore() {\n        return useStore;\n      },\n      get useRouter() {\n        return useRouter;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","onMounted","axios","useStore","useRouter","router","store","username","password","confirmPassword","name","lastName","gender","birthDate","worksAtFactoryId","errors","token","state","payload","JSON","parse","atob","split","userId","userRole","role","loadFactory","get","then","response","value","data","id","catch","error","console","validateUsername","validatePassword","validateName","validateLastName","validateBirthDate","register","userToRegister","post","push"],"sources":["C:/Programiranje/veb/projekat/chocolate-factoryapp/Frontend/front-app/src/components/RegisterWorker.vue"],"sourcesContent":["<template>\r\n  <form @submit.prevent=\"register\" class=\"register-form\">\r\n    <h2>Please register a Worker!</h2>\r\n    <div>\r\n      <label>Username:</label>\r\n      <input type=\"text\" v-model=\"username\" placeholder=\"Username\" @blur=\"validateUsername\"/>\r\n      <span v-if=\"errors.username\" class=\"error\">{{ errors.username }}</span>\r\n    </div>\r\n    <div>\r\n      <label>Password:</label>\r\n      <input type=\"password\" v-model=\"password\" @input=\"validatePassword\"/>\r\n      <span v-if=\"errors.password\" class=\"error\">{{ errors.password }}</span>\r\n    </div>\r\n    <div>\r\n      <label>Confirm Password:</label>\r\n      <input type=\"password\" v-model=\"confirmPassword\" @input=\"validatePassword\"/>\r\n      <span v-if=\"errors.confirmPassword\" class=\"error\">{{ errors.confirmPassword }}</span>\r\n    </div>\r\n    <div>\r\n      <label>Name:</label>\r\n      <input type=\"text\" v-model=\"name\" placeholder=\"Name\" @blur=\"validateName\"/>\r\n      <span v-if=\"errors.name\" class=\"error\">{{ errors.name }}</span>\r\n    </div>\r\n    <div>\r\n      <label>Last Name:</label>\r\n      <input type=\"text\" v-model=\"lastName\" placeholder=\"Lastname\" @blur=\"validateLastName\"/>\r\n      <span v-if=\"errors.lastName\" class=\"error\">{{ errors.lastName }}</span>\r\n    </div>\r\n    <div>\r\n      <label>Gender:</label>\r\n      <select name=\"gender\" id=\"gender\" form=\"gender\" v-model=\"gender\">\r\n        <option value=\"Male\">Male</option>\r\n        <option value=\"Female\">Female</option>\r\n        <option value=\"Other\">Other</option>\r\n      </select>\r\n    </div>\r\n    <div>\r\n      <label>Date of Birth:</label>\r\n      <input type=\"date\" v-model=\"birthDate\" @blur=\"validateBirthDate\"/>\r\n      <span v-if=\"errors.birthDate\" class=\"error\">{{ errors.birthDate }}</span>\r\n    </div>\r\n    <button type=\"submit\">Register</button>\r\n  </form>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted } from 'vue';\r\nimport axios from 'axios';\r\nimport { useStore } from 'vuex';\r\nimport { useRouter } from 'vue-router';\r\n\r\nconst router = useRouter();\r\nconst store = useStore();\r\n\r\nconst username = ref('');\r\nconst password = ref('');\r\nconst confirmPassword = ref('');\r\nconst name = ref('');\r\nconst lastName = ref('');\r\nconst gender = ref('Male');\r\nconst birthDate = ref('');\r\nconst worksAtFactoryId = ref('');\r\nconst errors = ref({});\r\n\r\nconst token = store.state.token; // Get token from the store\r\n\r\nconst payload = JSON.parse(atob(token.split('.')[1]));\r\nconst userId = payload.userId;\r\nconst userRole = payload.role;\r\n\r\nonMounted(() => {\r\n  loadFactory();\r\n});\r\n\r\nfunction loadFactory() {\r\n  axios.get(`http://localhost:3001/api/factories/manager/${userId}`)\r\n    .then(response => {\r\n      worksAtFactoryId.value = response.data.id;\r\n    })\r\n    .catch(error => {\r\n      console.error('There was an error fetching the factories!', error);\r\n    });\r\n}\r\n\r\nfunction validateUsername() {\r\n  if (!username.value) {\r\n    errors.value.username = 'Username is required';\r\n  } else {\r\n    errors.value.username = '';\r\n  }\r\n}\r\n\r\nfunction validatePassword() {\r\n  if (!password.value) {\r\n    errors.value.password = 'Password is required';\r\n  } else if (password.value !== confirmPassword.value) {\r\n    errors.value.confirmPassword = 'Passwords do not match';\r\n  } else {\r\n    errors.value.password = '';\r\n    errors.value.confirmPassword = '';\r\n  }\r\n}\r\n\r\nfunction validateName() {\r\n  if (!name.value) {\r\n    errors.value.name = 'Name is required';\r\n  } else {\r\n    errors.value.name = '';\r\n  }\r\n}\r\n\r\nfunction validateLastName() {\r\n  if (!lastName.value) {\r\n    errors.value.lastName = 'Last Name is required';\r\n  } else {\r\n    errors.value.lastName = '';\r\n  }\r\n}\r\n\r\nfunction validateBirthDate() {\r\n  if (!birthDate.value) {\r\n    errors.value.birthDate = 'Date of Birth is required';\r\n  } else {\r\n    errors.value.birthDate = '';\r\n  }\r\n}\r\n\r\nfunction register() {\r\n  validateUsername();\r\n  validatePassword();\r\n  validateName();\r\n  validateLastName();\r\n  validateBirthDate();\r\n\r\n  if (\r\n    errors.value.username ||\r\n    errors.value.password ||\r\n    errors.value.confirmPassword ||\r\n    errors.value.name ||\r\n    errors.value.lastName ||\r\n    errors.value.birthDate\r\n  ) {\r\n    return;\r\n  }\r\n\r\n  const userToRegister = {\r\n    username: username.value,\r\n    password: password.value,\r\n    name: name.value,\r\n    lastName: lastName.value,\r\n    gender: gender.value,\r\n    birthDate: birthDate.value,\r\n    worksAtFactoryId: worksAtFactoryId.value\r\n  };\r\n\r\n  axios.post(`http://localhost:3001/api/signupworker`, userToRegister)\r\n    .then(response => {\r\n      router.push('/login');\r\n    })\r\n    .catch(error => {\r\n      if (error.response && error.response.data.error === 'Username already exists') {\r\n        errors.value.username = 'Username already taken';\r\n      } else {\r\n        console.error('There was an error registering!', error);\r\n      }\r\n    });\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.register-form {\r\n  max-width: 600px;\r\n  margin: 0 auto;\r\n  padding: 20px;\r\n  background-color: #f5f5f5;\r\n  border-radius: 10px;\r\n  box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);\r\n}\r\n\r\n.register-form h2 {\r\n  text-align: center;\r\n  color: #4b3832;\r\n  font-family: 'Arial', sans-serif;\r\n  font-size: 2em;\r\n  font-weight: bold;\r\n  margin-bottom: 20px;\r\n  text-transform: uppercase;\r\n  font-style: italic;\r\n}\r\n\r\n.register-form div {\r\n  margin-bottom: 15px;\r\n}\r\n\r\n.register-form label {\r\n  display: block;\r\n  margin-bottom: 5px;\r\n  font-weight: bold;\r\n}\r\n\r\n.register-form input,\r\n.register-form select {\r\n  width: 100%;\r\n  padding: 8px;\r\n  box-sizing: border-box;\r\n  border: 1px solid #ccc;\r\n  border-radius: 5px;\r\n}\r\n\r\n.register-form button {\r\n  display: block;\r\n  width: 100%;\r\n  padding: 10px;\r\n  background-color: #42b983;\r\n  color: white;\r\n  border: none;\r\n  border-radius: 5px;\r\n  cursor: pointer;\r\n  font-size: 1em;\r\n}\r\n\r\n.register-form button:hover {\r\n  background-color: #3a9d70;\r\n}\r\n\r\n.error {\r\n  color: red;\r\n  font-size: 0.8em;\r\n}\r\n</style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}